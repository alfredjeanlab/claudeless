# Capture agent team creation and teammate spawn.
# Requires API call - Claude spawns teammate instances.
# Args: --model haiku --teammate-mode in-process --dangerously-skip-permissions
# Env: CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1
# Timeout: 300

# Accept the bypass confirmation dialog (select "Yes, I accept")
wait "No, exit" 10s
send <Down>
wait 100
send <Enter>

wait "bypass permissions on" 10s

# Ask Claude to create a small team
send "Create an agent team with 2 members to research SQLite vs PostgreSQL for a CLI tool." 200 <Enter>

# Wait for team to spawn â€” "agents launched" appears in lead output
wait "agents launched" 120s
wait 5s
snapshot "agent_team_spawned"

# Let teammates work briefly, then snapshot the inline task progress
wait 30s
snapshot "agent_team_working"

send <C-u> 200 "/exit" 200 <Enter>
wait 500
kill TERM
